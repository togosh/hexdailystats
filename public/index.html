<!DOCTYPE html>
<html lang="en">
<head>
    <title>HEXDailyStats</title> 
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/v/dt/dt-1.10.25/b-1.7.1/b-html5-1.7.1/b-print-1.7.1/date-1.1.0/fh-3.1.9/kt-2.6.2/datatables.min.css"/>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.datatables.net/1.10.25/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/v/dt/dt-1.10.25/b-1.7.1/b-html5-1.7.1/b-print-1.7.1/date-1.1.0/fh-3.1.9/kt-2.6.2/datatables.min.js"></script>
    <script src="/socket.io/socket.io.js"></script>
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/buttons/1.7.1/css/buttons.dataTables.min.css"/> 
    <script src="https://cdn.datatables.net/buttons/1.7.1/js/dataTables.buttons.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js"></script>
    <script src="https://cdn.datatables.net/fixedcolumns/3.3.3/js/dataTables.fixedColumns.min.js"></script>
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/fixedcolumns/3.3.3/css/fixedColumns.dataTables.min.css"/> 

    <script>
        var currencyFormatter = new Intl.NumberFormat(undefined, { style: 'currency', currency: 'USD'});
        var currencyFormatterPrice = new Intl.NumberFormat(undefined, { style: 'currency', currency: 'USD', minimumFractionDigits: 6});

        var socket = io.connect();

        socket.on('rowData', function (data) {
            $('#dataTable').DataTable({
                destroy: true,
                data: data,
                scrollX: true,
                scrollY: "370px",
                scrollCollapse: true,
                order: [[ 0, "desc" ]],
                dom: 'Bfrtip',
                
                buttons: [
                    {
                        extend: "copy",
                        exportOptions: { orthogonal: "exportcopy" }
                    },
                    {
                        extend: "csvHtml5",
                        exportOptions: { orthogonal: "exportcsv" }
                    },
                    {
                        extend: "excelHtml5",
                        exportOptions: { orthogonal: "exportxls" }
                    },
                    {
                        extend: "print",
                        exportOptions: { orthogonal: "exportprint" }
                    }
                ],
                fixedColumns: {
                    leftColumns: 1
                },
                columns: [
                    { title: "Day" },
                    { title: "Date", render: function (data, type, row) {
                            if (type === "display" || type === "filter") { 
                                var date = new Date(data);
                                date.setDate(date.getDate() - 1);
                                var month = date.getUTCMonth() + 1;
                                return (month.toString().length > 1 ? month : "0" + month) + "/" + date.getUTCDate() + "/" + date.getUTCFullYear();
                            }
                            return data;
                        }
                    },

                    { title: "T-Share Rate (HEX)", render: function(data, type, row) {
                            if (type === "display" || type === "filter") { 
                                return Number(data).toLocaleString(); }
                            return data;
                        }
                    },
                    { title: "Increase in  T-Share Rate (HEX)", render: function(data, type, row) {
                            if (type === "display" || type === "filter") { 
                                return Number(data).toLocaleString(); }
                            return data;
                        }
                    },
                    { title: "T-Share Rate (USD)", render: function(data, type, row) {
                            if (type === "display" || type === "filter") { 
                                return currencyFormatter.format(data); }
                            return data;
                        }
                    },

                    { title: "Total T-Shares (Shares)", render: function(data, type, row) {
                            if (type === "display" || type === "filter") { 
                                return Number(data).toLocaleString(); }
                            return data;
                        }
                    },
                    { title: "Daily Change in Total T-Shares (Shares)", render: function(data, type, row) {
                            if (type === "display" || type === "filter") {
                                if (data < 0) { 
                                    return "(" + Number(data).toLocaleString() + ")";
                                } 
                                return Number(data).toLocaleString(); 
                            }
                            return data;
                        }
                    },

                    { title: "Payout Per T-Share (HEX)" },
                    { title: "Actual APY Rate (Interest + EES Penalties)", render: function(data, type, row) {
                            if (type === "display" || type === "filter") { 
                                return Number(data/100).toLocaleString(undefined,{style: 'percent', minimumFractionDigits:2}); } 
                            return data;
                        }
                    },
                    

                    { title: "Staked % of Coins", render: function(data, type, row) {
                            if (type === "display" || type === "filter") { 
                                return Number(data/100).toLocaleString(undefined,{style: 'percent', minimumFractionDigits:2}); } 
                            return data;
                        }
                    },
                    { title: "Daily Change in Staked % of Coins", render: function(data, type, row) {
                            if (type === "display" || type === "filter") { 
                                return Number(data/100).toLocaleString(undefined,{style: 'percent', minimumFractionDigits:2}); } 
                            return data;
                        }
                    },
                    { title: "Avg Stake Length (Years)" },

                    { title: "Daily HEX Penalties (HEX)", render: function(data, type, row) {
                            if (type === "display" || type === "filter") { 
                                return Number(data).toLocaleString(); }
                            return data;
                        }
                    },
                    { title: "Daily Price (USD)", render: function(data, type, row) {
                            if (type === "display" || type === "filter") { 
                                return currencyFormatterPrice.format(data); }
                            return data;
                        }
                    },
                    { title: "Daily % Price Change (USD)", render: function(data, type, row) {
                            if (type === "display" || type === "filter") { 
                                return Number(data/100).toLocaleString(undefined,{style: 'percent', minimumFractionDigits:2}); } 
                            return data;
                        }
                    },

                    { title: "Total HEX Liquidity Pool (V2 + V3)", render: function(data, type, row) {
                            if (type === "display" || type === "filter") { 
                                return Number(data).toLocaleString(); }
                            return data;
                        }
                    },
                    { title: "Total USDC Liquidity Pool (V2 + V3)", render: function(data, type, row) {
                            if (type === "display" || type === "filter") { 
                                return Number(data).toLocaleString(); }
                            return data;
                        }
                    },
                    { title: "Total ETH Liquidity Pool (V2 + V3)", render: function(data, type, row) {
                            if (type === "display" || type === "filter") { 
                                return Number(data).toLocaleString(); }
                            return data;
                        }
                    },

                    { title: "Total Circulating + Staked", render: function(data, type, row) {
                            if (type === "display" || type === "filter") { 
                                return Number(data).toLocaleString(); }
                            return data;
                        }
                    },
                    { title: "Daily Minted Inflation Total", render: function(data, type, row) {
                            if (type === "display" || type === "filter") { 
                                return Number(data).toLocaleString(); }
                            return data;
                        }
                    },
                    
                    { title: "Circulating Supply", render: function(data, type, row) {
                            if (type === "display" || type === "filter") { 
                                return Number(data).toLocaleString(); }
                            return data;
                        }
                    },
                    { title: "Daily Change in Circulating Supply", render: function(data, type, row) {
                            if (type === "display" || type === "filter") {
                                if (data < 0) { 
                                    return "(" + Number(data).toLocaleString() + ")";
                                } 
                                return Number(data).toLocaleString(); 
                            }
                            return data;
                        }
                    },
                    { title: "Staked Supply", render: function(data, type, row) {
                            if (type === "display" || type === "filter") { 
                                return Number(data).toLocaleString(); }
                            return data;
                        }
                    },
                    { title: "Daily Change in Staked Supply", render: function(data, type, row) {
                            if (type === "display" || type === "filter") {
                                if (data < 0) { 
                                    return "(" + Number(data).toLocaleString() + ")";
                                } 
                                return Number(data).toLocaleString(); 
                            }
                            return data;
                        }
                    },

                    { title: "Daily Payout", render: function(data, type, row) {
                            if (type === "display" || type === "filter") { 
                                return Number(data).toLocaleString(); }
                            return data;
                        }
                    },
                    { title: "Number of Holders", render: function(data, type, row) {
                            if (type === "display" || type === "filter") { 
                                return Number(data).toLocaleString(); }
                            return data;
                        }
                    },
                    { title: "Daily Change in Number of Holders", render: function(data, type, row) {
                            if (type === "display" || type === "filter") {
                                if (data < 0) { 
                                    return "(" + Number(data).toLocaleString() + ")";
                                } 
                                return Number(data).toLocaleString(); 
                            }
                            return data;
                        }
                    },
                    
                ]
            });
        });

    </script>
    <style>
        a { color:black; }
    </style>
</head>
<body style="background-color:lightgrey;">
<div>
    <a href="https://t.me/HEXDailyStats"><div class="headerSection" style="background-color: lightblue; position:fixed; top: 0; left: 0; width: 100%; height: 30px; padding-top: 10px">
        <center><div>Under construction. Click to give feedback!</div></center>
    </div></a>
    <div id="mainSection" style="padding-top: 32px">
        <center><img src="hexdailystatslogo.png" style="max-width: 100%"></img></center>
        <center><div style="font-size:20px; padding-bottom: 10px">
        <a href="about.html">About</a> | 
        <a href="https://hex.com/">What is HEX?</a> |
        <a href="https://twitter.com/HEXDailyStats">Twitter</a> |
        <a href="https://t.me/HEXDailyStats">Telegram</a>
        </div></center>
        <table id="dataTable" class="display" width="100%" data-page-length='30'></table>
    </div>
</div>